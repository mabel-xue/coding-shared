#

## ES10 | js

ES10ä»ç„¶åªæ˜¯ä¸€ä¸ªè‰æ¡ˆ(æˆªæ­¢è‡³2019-11-7)ï¼Œä½†æ˜¯é™¤äº† Object.fromEntrieså¤§å¤šæ•°åŠŸèƒ½å·²ç»åœ¨ Chromeä¸­å®ç°ï¼š

### BigInt - ä»»æ„ç²¾åº¦æ•´æ•°

```BigInt```æ˜¯ç¬¬7ç§åŸå§‹ç±»å‹ã€‚

```BigInt```æ˜¯ä¸€ä¸ªä»»æ„ç²¾åº¦çš„æ•´æ•°ã€‚è¿™æ„å‘³ç€å˜é‡ç°åœ¨å¯ä»¥ä»£è¡¨2^53ä¸ªæ•°å­—ã€‚è€Œä¸”æœ€å¤§é™åº¦æ˜¯9007199254740992ã€‚

```const b = 1n; //è¿½åŠ næ¥åˆ›å»ºä¸€ä¸ªBigInt```

åœ¨è¿‡å»çš„æ•´æ•°å€¼å¤§äº9007199254740992ä¸æ”¯æŒã€‚å¦‚æœè¶…å‡ºï¼Œåˆ™è¯¥å€¼å°†é”å®šä¸º ```MAX_SAFE_INTEGER + 1```ï¼š

```js
const limit = Number.MAX_SAFE_INTEGER;
â‡¨ 9007199254740991
limit + 1; 
â‡¨ 9007199254740992
limit + 2; 
â‡¨ 9007199254740992 <--- MAX_SAFE_INTEGER + 1 exceeded
const larger = 9007199254740991n;
â‡¨ 9007199254740991n
const integer = BigInt(9007199254740991); // initialize with number
â‡¨ 9007199254740991n
const same = BigInt("9007199254740991"); // initialize with "string"
â‡¨ 9007199254740991n

typeof 10;
â‡¨ 'number'
typeof 10n;
â‡¨ 'bigint'

10n === BigInt(10);
â‡¨ true
10n == 10;
â‡¨ true

200n / 10n
â‡¨ 20n
200n / 20
â‡¨ Uncaught TypeError:
   Cannot mix BigInt and other types, use explicit conversions <

-100n
â‡¨ -100n
+100n
â‡¨ Uncaught TypeError:
  Cannot convert a BigInt value to a number
```

### string.prototype.matchAll()

```js
// Match all occurrences of the letters: 'e' æˆ–è€… 'l'
let iterator = 'hello'.matchAll(/[el]/)
for (const match of iterator) {
    console.log(match)
}

// å¦‚ä¸Šï¼Œä½ å¯ä»¥è·³è¿‡ /gï¼Œ .matchAllä¸éœ€è¦å®ƒã€‚ç»“æœï¼š

[ 'e', index: 1, input: 'hello' ] // Iteration 1
[ 'l', index: 2, input: 'hello' ] // Iteration 2
[ 'l', index: 3, input: 'hello' ] // Iteration 3
```

### åŠ¨æ€ import

ç°åœ¨å¯ä»¥å°†å¯¼å…¥åˆ†é…ç»™ä¸€ä¸ªå˜é‡ï¼š

```js
element.addEventListener('click', async () => {
    const module = await import('./api-scripts/button-click.js')
    module.clickEvent()
})
```

### Array.flat()

```js
let multi = [1,2,3,[4,5,6,[7,8,9,[10,11,12]]]];
multi.flat();               // [1,2,3,4,5,6,Array(4)]
multi.flat().flat();        // [1,2,3,4,5,6,7,8,9,Array(3)]
multi.flat().flat().flat(); // [1,2,3,4,5,6,7,8,9,10,11,12]
multi.flat(Infinity);       // [1,2,3,4,5,6,7,8,9,10,11,12]
```

### Array.flatMap()

```js
let array = [1, 2, 3, 4, 5]
array.map(x => [x, x * 2])

å˜ä¸ºï¼š

[Array(2), Array(2), Array(2)]
0: (2)[1, 2]
1: (2)[2, 4]
2: (2)[3, 6]
3: (2)[4, 8]
4: (2)[5, 10]


å†æ¬¡æ‰å¹³åŒ–æ•°ç»„ï¼š

array.flatMap(v => [v, v * 2])
[1, 2, 2, 4, 3, 6, 4, 8, 5, 10]
```

### Object.fromEntries()

```js
å°†é”®å€¼å¯¹åˆ—è¡¨è½¬æ¢ä¸ºå¯¹è±¡ã€‚

let obj = { apple : 10, orange : 20, banana : 30 };
let entries = Object.entries(obj);
entries;
(3) [Array(2), Array(2), Array(2)]
 0: (2) ["apple", 10]
 1: (2) ["orange", 20]
 2: (2) ["banana", 30]
let fromEntries = Object.fromEntries(entries);
{ apple: 10, orange: 20, banana: 30 }
```

### String.trimStart() & String.trimEnd()

```js
let greeting = "     Space around     ";
greeting.trimEnd();   // "     Space around";
greeting.trimStart(); // "Space around     ";
```

### ç¨³å®šçš„Array.prototype.sort()

V8çš„å…ˆå‰å®ç°å¯¹åŒ…å«10ä¸ªä»¥ä¸Šé¡¹çš„æ•°ç»„ä½¿ç”¨äº†ä¸ç¨³å®šçš„å¿«é€Ÿæ’åºç®—æ³•ã€‚

ä¸€ä¸ªç¨³å®šçš„æ’åºç®—æ³•æ˜¯å½“ä¸¤ä¸ªå…·æœ‰ç›¸ç­‰é”®çš„å¯¹è±¡åœ¨æ’åºè¾“å‡ºä¸­ä»¥ä¸æœªæ’åºè¾“å…¥ä¸­å‡ºç°çš„é¡ºåºç›¸åŒçš„é¡ºåºå‡ºç°æ—¶ã€‚

ä½†ç°åœ¨å·²ç»ä¸æ˜¯è¿™æ ·äº†ã€‚ES10æä¾›ç¨³å®šçš„é˜µåˆ—æ’åºï¼š

```js
var fruit = [
    { name: "Apple",      count: 13, },
    { name: "Pear",       count: 12, },
    { name: "Banana",     count: 12, },
    { name: "Strawberry", count: 11, },
    { name: "Cherry",     count: 11, },
    { name: "Blackberry", count: 10, },
    { name: "Pineapple",  count: 10, }
];
// Create our own sort criteria function:
let my_sort = (a, b) => a.count - b.count;
// Perform stable ES10 sort:
let sorted = fruit.sort(my_sort);
console.log(sorted);
```

### New Function.toString()

Funcitonsæ˜¯å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸ª .toString()æ–¹æ³•å› ä¸ºå®ƒæœ€åˆå­˜åœ¨äº Object.prototype.toString()ã€‚æ‰€æœ‰çš„ objectsï¼ˆåŒ…æ‹¬functionsï¼‰éƒ½ç»§æ‰¿è‡³åŸºäºåŸå‹çš„ç±»ç»§æ‰¿ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å·²ç»æœ‰äº† function.toString()æ–¹æ³•äº†ã€‚

ä½†æ˜¯ES10è¿›ä¸€æ­¥å°è¯•æ ‡å‡†åŒ–æ‰€æœ‰å¯¹è±¡å’Œå†…ç½®å‡½æ•°çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ä»¥ä¸‹æ–°æ¡ˆä¾‹ï¼š

```js
Classic example
function () { console.log('Hello there.'); }.toString();


æ§åˆ¶å°è¾“å‡ºï¼ˆå­—ç¬¦ä¸²æ ¼å¼çš„å‡½æ•°ä½“:)

â‡¨ function () { console.log('Hello there.'); }


ä»¥ä¸‹æ˜¯å…¶å®ƒæ¡ˆä¾‹ï¼š

ç›´æ¥æ¥è‡ªå‡½æ•°å
Number.parseInt.toString();
â‡¨ function parseInt() { [native code] }


ç»‘å®šä¸Šä¸‹æ–‡
function () { }.bind(0).toString();
â‡¨ function () { [native code] }


å†…ç½®å¯è°ƒç”¨å‡½æ•°å¯¹è±¡
Symbol.toString();
â‡¨ function Symbol() { [native code] }


åŠ¨æ€ç”Ÿæˆçš„å‡½æ•°
Function().toString();
â‡¨ function anonymous() {}


åŠ¨æ€ç”Ÿæˆçš„ç”Ÿæˆå™¨ function*
function* () { }.toString();
â‡¨ function* () { }


prototype.toString
Function.prototype.toString.call({});
â‡¨ Function.prototype.toString requires that 'this' be a Function"
```

### å¯é€‰çš„Catch Binding

åœ¨è¿‡å»ï¼Œ try / catchè¯­å¥ä¸­çš„ catchå­å¥éœ€è¦ä¸€ä¸ªå˜é‡ã€‚

try / catchè¯­å¥å¸®åŠ©æˆ‘ä»¬æ‹¦æˆªåœ¨ç»ˆç«¯å±‚é¢çš„é”™è¯¯ï¼š

```js
try {
    // Call a non-existing function undefined_Function
    undefined_Function("I'm trying");
}
catch(error) {
    // Display the error if statements inside try above fail
    console.log( error ); // undefined_Function is undefined
}
```

ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‰€éœ€çš„ errorå˜é‡æœªè¢«ä½¿ç”¨ï¼š

ä½ ç°åœ¨å¯ä»¥è·³è¿‡ errorå˜é‡ï¼š

```js
try {
    JSON.parse(text);
    return true;
}
catch
{
    return false;
}
```

### æ ‡å‡†åŒ–çš„ globalThis å¯¹è±¡

ES10ä¹‹å‰å…¨å±€ thisæ²¡æœ‰æ ‡å‡†åŒ–ã€‚ES10æ·»åŠ äº† globalThiså¯¹è±¡ï¼Œä»ç°åœ¨å¼€å§‹åº”è¯¥åœ¨ä»»ä½•å¹³å°ä¸Šè®¿é—®å…¨å±€ä½œç”¨åŸŸï¼š

```js
// Access global array constructor
globalThis.Array(0, 1, 2);
â‡¨ [0, 1, 2]

// Similar to window.v = { flag: true } in <= ES5
globalThis.v = { flag: true };

console.log(globalThis.v);
â‡¨ { flag: true }
```

### Symbol.description

```js
let mySymbol = 'My Symbol';
let symObj = Symbol(mySymbol);
symObj; // Symbol(My Symbol)
String(symObj) === `Symbol(${mySymbol})`); // true
symObj.description; // "My Symbol"
```

ğŸ’¬[ES10 åŠŸèƒ½å®Œå…¨æŒ‡å—](https://mp.weixin.qq.com/s/l9x0BPU3ylDt4G2VwUwf_A)
