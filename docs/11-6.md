# Whatâ€™s Improvement

<!-- TODO -->
## JS åŸç”Ÿé¢ç»ä»åˆçº§åˆ°é«˜çº§ | js/é¢è¯•

### 1. å‡½æ•°

1.1 å‡½æ•°çš„3ç§å®šä¹‰æ–¹æ³•

#### 1.2 ES5ä¸­å‡½æ•°çš„4ç§è°ƒç”¨

##### 1.2.4 é—´æ¥è°ƒç”¨

åˆ©ç”¨callå’Œapplyæ¥å®ç°,thiså°±æ˜¯callå’Œapplyå¯¹åº”çš„ç¬¬ä¸€ä¸ªå‚æ•°,å¦‚æœä¸ä¼ å€¼æˆ–è€…ç¬¬ä¸€ä¸ªå€¼ä¸ºnull,undefinedæ—¶thisæŒ‡å‘window

```js
function foo() {
   console.log(this);
}
foo.apply('æˆ‘æ˜¯applyæ”¹å˜çš„thiså€¼');//æˆ‘æ˜¯applyæ”¹å˜çš„thiså€¼
foo.call('æˆ‘æ˜¯callæ”¹å˜çš„thiså€¼');//æˆ‘æ˜¯callæ”¹å˜çš„thiså€¼
```

#### 1.3 ES6ä¸­å‡½æ•°çš„è°ƒç”¨

ç®­å¤´å‡½æ•°ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ç”¨newå‘½ä»¤å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯
ç®­å¤´å‡½æ•°çš„thisæ˜¯å’Œå®šä¹‰æ—¶æœ‰å…³å’Œè°ƒç”¨æ— å…³
è°ƒç”¨å°±æ˜¯å‡½æ•°è°ƒç”¨æ¨¡å¼

```js
(() => {
   console.log(this)//window
})()

let arrowFun = () => {
  console.log(this)//window
}
arrowFun()

let arrowObj = {
  arrFun: function() {
   (() => {
     console.log(this)//æŒ‡å‘å‡½æ•°arrFun
   })()
   }
 }
 arrowObj.arrFun();
```

#### 1.4 call,applyå’Œbind

1.IE5ä¹‹å‰ä¸æ”¯æŒcallå’Œapply,bindæ˜¯ES5å‡ºæ¥çš„;
2.callå’Œapplyå¯ä»¥è°ƒç”¨å‡½æ•°,æ”¹å˜this,å®ç°ç»§æ‰¿å’Œå€Ÿç”¨åˆ«çš„å¯¹è±¡çš„æ–¹æ³•;

##### 1.4.1 callå’Œapplyå®šä¹‰

è°ƒç”¨æ–¹æ³•,ç”¨ä¸€ä¸ªå¯¹è±¡æ›¿æ¢æ‰å¦ä¸€ä¸ªå¯¹è±¡(this)
å¯¹è±¡.call(æ–°thiså¯¹è±¡,å®å‚1,å®å‚2,å®å‚3.....)
å¯¹è±¡.apply(æ–°thiså¯¹è±¡,[å®å‚1,å®å‚2,å®å‚3.....])

##### 1.4.2 callå’Œapplyç”¨æ³•

1.é—´æ¥è°ƒç”¨å‡½æ•°,æ”¹å˜ä½œç”¨åŸŸçš„thiså€¼
2.åŠ«æŒå…¶ä»–å¯¹è±¡çš„æ–¹æ³•

```js
var foo = {
  name:"å¼ ä¸‰",
  logName:function(){
    console.log(this.name);
  }
}
var bar={
  name:"æå››"
};
foo.logName.call(bar);//æå››
```

å®è´¨æ˜¯callæ”¹å˜äº†fooçš„thisæŒ‡å‘ä¸ºbar,å¹¶è°ƒç”¨è¯¥å‡½æ•°

3.ä¸¤ä¸ªå‡½æ•°å®ç°ç»§æ‰¿

```js
function Animal(name){
  this.name = name;   
  this.showName = function(){   
    console.log(this.name);   
  }   
}   
function Cat(name){  
  Animal.call(this, name);  
}    
var cat = new Cat("Black Cat");   
cat.showName(); //Black Cat
```

4.ä¸ºç±»æ•°ç»„(argumentså’ŒnodeList)æ·»åŠ æ•°ç»„æ–¹æ³•push,pop

```js
(function(){
  Array.prototype.push.call(arguments,'ç‹äº”');
  console.log(arguments);//['å¼ ä¸‰','æå››','ç‹äº”']
})('å¼ ä¸‰','æå››')
```

5.åˆå¹¶æ•°ç»„

```js
let arr1=[1,2,3]; 
let arr2=[4,5,6]; 
Array.prototype.push.apply(arr1,arr2); //å°†arr2åˆå¹¶åˆ°äº†arr1ä¸­
```

6.æ±‚æ•°ç»„æœ€å¤§å€¼

```js
Math.max.apply(null,arr)
```

7.åˆ¤æ–­å­—ç¬¦ç±»å‹

```js
Object.prototype.toString.call({})
```

##### 1.4.3 bind

bindæ˜¯functionçš„ä¸€ä¸ªå‡½æ•°æ‰©å±•æ–¹æ³•ï¼Œbindä»¥åä»£ç é‡æ–°ç»‘å®šäº†funcå†…éƒ¨çš„thisæŒ‡å‘,ä¸ä¼šè°ƒç”¨æ–¹æ³•,ä¸å…¼å®¹IE8

```js
var name = 'æå››'
 var foo = {
   name: "å¼ ä¸‰",
   logName: function(age) {
   console.log(this.name, age);
   }
 }
 var fooNew = foo.logName;
 var fooNewBind = foo.logName.bind(foo);
 fooNew(10)//æå››,10
 fooNewBind(11)//å¼ ä¸‰,11  å› ä¸ºbindæ”¹å˜äº†fooNewBindé‡Œé¢çš„thisæŒ‡å‘
 ```

##### 1.4.4 call,applyå’ŒbindåŸç”Ÿå®ç°

é€šç”¨ä»£ç :

```js
let person = {
  name: 'Abiel'
}
function sayHi(age,sex) {
  console.log(this.name, age, sex);
}
```

callå®ç°:

```js
Function.prototype.newCall = function(context, ...parameter) {
 if (typeof context === 'object' || typeof context === 'function') {
    context = context || window
} else {
    context = Object.create(null)
}
  context['fn'] = this  
  const res =context['fn'](...parameter)
  delete context.fn;
  return res
}
sayHi.newCall (person, 25, 'ç”·'); // Abiel 25 ç”·
```

applyå®ç°: åŒcallå®ç°ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯applyåªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¤šå‚ä»¥æ•°å­—çš„å½¢å¼ä¼ å…¥

```js
Function.prototype.newApply = function(context, parameter) {
  if (typeof context === 'object' || typeof context === 'function') {
    context = context || window
  } else {
    context = Object.create(null)
  }
  let fn = Symbol()
  context[fn] = this
  const res=context[fn](...parameter);
  delete context[fn]
  return res
}
sayHi.newApply (person,[ 25, 'ç”·']) //Abiel 25 ç”·
```

bindå®ç°:

```js
Function.prototype.bind = function (context,...innerArgs) {
  var me = this
  return function (...finnalyArgs) {
    return me.call(context,...innerArgs,...finnalyArgs)
  }
}
let personSayHi = sayHi.bind(person, 25)
personSayHi('ç”·')
```

##### 1.4.5 ä¸‰è€…å¼‚åŒ

åŒ:éƒ½æ˜¯æ”¹å˜thisæŒ‡å‘,éƒ½å¯æ¥æ”¶å‚æ•°
å¼‚:bindå’Œcallæ˜¯æ¥æ”¶å•ä¸ªå‚æ•°,applyæ˜¯æ¥æ”¶æ•°ç»„ï¼›callå’Œapplyéƒ½æ˜¯å¯¹å‡½æ•°çš„ç›´æ¥è°ƒç”¨ï¼Œè€Œbindæ–¹æ³•è¿”å›çš„ä»ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œéœ€å†è¿›è¡Œè°ƒç”¨

#### 1.5.å‡½æ•°çš„é˜²æŠ–å’ŒèŠ‚æµ (è¯¦è§7-16)

| ç±»å‹ | æ¦‚å¿µ                                    | åº”ç”¨                                |
| ---- | ----------------------------------------- | ------------------------------------- |
| é˜²æŠ– | äº‹ä»¶è§¦å‘åŠ¨ä½œå®Œåä¸€æ®µæ—¶é—´è§¦å‘ä¸€æ¬¡ | scroll,resizeäº‹ä»¶è§¦å‘å®Œåä¸€æ®µæ—¶é—´è§¦å‘ |
| èŠ‚æµ | äº‹ä»¶è§¦å‘åæ¯éš”ä¸€æ®µæ—¶é—´è§¦å‘ä¸€æ¬¡,å¯è§¦å‘å¤šæ¬¡ | scroll,resizeäº‹ä»¶ä¸€æ®µæ—¶é—´è§¦å‘å¤šæ¬¡ |

#### 1.6.åŸå‹é“¾

1.6.1 å®šä¹‰
å¯¹è±¡ç»§æ‰¿å±æ€§çš„ä¸€ä¸ªé“¾æ¡

##### 1.6.2æ„é€ å‡½æ•°,å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»

![pic1](/image/proto_rel.png)

```js
var Person = function (name) { this.name = name; }//personæ˜¯æ„é€ å‡½æ•°
var o3personTwo = new Person('personTwo')//personTwoæ˜¯å®ä¾‹
```

![pic2](/image/proto_rel2.png)

åŸå‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„constructorå±æ€§æŒ‡å‘æ„é€ å‡½æ•°

1.6.3 åˆ›å»ºå®ä¾‹çš„æ–¹æ³•

##### 1.6.5 å¯¹è±¡çš„åŸå‹é“¾

![pic3](/image/prototype_of_object.jpeg)

#### 1.7 ç»§æ‰¿çš„æ–¹å¼

##### 1.7.1 åŸå‹é“¾ç»§æ‰¿

å°†çˆ¶ç±»çš„å®ä¾‹ä½œä¸ºå­ç±»çš„åŸå‹

- 1.ä»£ç å®ç°
å®šä¹‰çˆ¶ç±»:

```js
// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©ç±»
function Animal (name) {
  // å±æ€§
  this.name = name || 'Animal';
  // å®ä¾‹æ–¹æ³•
  this.sleep = function(){
    console.log(this.name + 'æ­£åœ¨ç¡è§‰ï¼');
  }
}
// åŸå‹æ–¹æ³•
Animal.prototype.eat = function(food) {
  console.log(this.name + 'æ­£åœ¨åƒï¼š' + food);
};
å­ç±»:

function Cat(){
}
Cat.prototype = new Animal();
Cat.prototype.name = 'cat';

//ã€€Test Code
var cat = new Cat();
console.log(cat.name);//cat
console.log(cat.eat('fish'));//catæ­£åœ¨åƒï¼šfish  undefined
console.log(cat.sleep());//catæ­£åœ¨ç¡è§‰ï¼ undefined
console.log(cat instanceof Animal); //true 
console.log(cat instanceof Cat); //true
```

- 2.ä¼˜ç¼ºç‚¹
ç®€å•æ˜“äºå®ç°,ä½†æ˜¯è¦æƒ³ä¸ºå­ç±»æ–°å¢å±æ€§å’Œæ–¹æ³•ï¼Œå¿…é¡»è¦åœ¨new Animal()è¿™æ ·çš„è¯­å¥ä¹‹åæ‰§è¡Œ,æ— æ³•å®ç°å¤šç»§æ‰¿

###### 1.7.2 æ„é€ ç»§æ‰¿

å®è´¨æ˜¯åˆ©ç”¨callæ¥æ”¹å˜Catä¸­çš„thisæŒ‡å‘

- 1.ä»£ç å®ç°

```js
å­ç±»:

function Cat(name){
  Animal.call(this);
  this.name = name || 'Tom';
}
```

- 2.ä¼˜ç¼ºç‚¹
å¯ä»¥å®ç°å¤šç»§æ‰¿,ä¸èƒ½ç»§æ‰¿åŸå‹å±æ€§/æ–¹æ³•

##### 1.7.3 å®ä¾‹ç»§æ‰¿

ä¸ºçˆ¶ç±»å®ä¾‹æ·»åŠ æ–°ç‰¹æ€§ï¼Œä½œä¸ºå­ç±»å®ä¾‹è¿”å›
1.ä»£ç å®ç°
å­ç±»

function Cat(name){
  var instance = new Animal();
  instance.name = name || 'Tom';
  return instance;
}
2.ä¼˜ç¼ºç‚¹
ä¸é™åˆ¶è°ƒç”¨æ–¹å¼,ä½†ä¸èƒ½å®ç°å¤šç»§æ‰¿

##### 1.7.4 æ‹·è´ç»§æ‰¿

å°†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•æ‹·è´ä¸€ä»½åˆ°å­ç±»ä¸­
1.å­ç±»:

function Cat(name){
  var animal = new Animal();
  for(var p in animal){
    Cat.prototype[p] = animal[p];
  }
  Cat.prototype.name = name || 'Tom';
}
2.ä¼˜ç¼ºç‚¹
æ”¯æŒå¤šç»§æ‰¿,ä½†æ˜¯æ•ˆç‡ä½å ç”¨å†…å­˜


ğŸ’¬[JS åŸç”Ÿé¢ç»ä»åˆçº§åˆ°é«˜çº§](https://segmentfault.com/a/1190000020759924)
