# What's Solution

## jsé«˜ä½æ•°è¿ç®—è¿›åº¦ä¸¢å¤±

è¯¥é—®é¢˜ä¸ºå‰ç«¯jså¤§æ•°è¿ç®—ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼Œå½“è¶…è¿‡16ä½æ•°æ—¶ä¼šå‡ºç°ä½ä½æ•°ä¸ç²¾å‡†ï¼Œè¿™æ˜¯ç”±äºå‰ç«¯jsåœ¨é«˜ä½æ•°è®¡ç®—æ—¶è½¬ä¸ºç§‘å­¦è®¡ç®—æ³•å¯¼è‡´ã€‚

è§£å†³æ–¹æ¡ˆï¼šå¯¹å‰åç«¯é™åˆ¶æ•°å­—ä½æ•°

# Whatâ€™s Improvement

## axeæ’ä»¶(chrome) | æ€§èƒ½ä¼˜åŒ–

é’ˆå¯¹Lighthouse-Accessibilityå¯¹ç½‘é¡µè°ƒè¯•ç‰ˆæä¾›å¯ä¼˜åŒ–æ–¹æ¡ˆ

ğŸ’¬[å®˜ç½‘](https://www.deque.com/axe/)

## JavaScript ä»£ç æœ€ä½³å®è·µ | ğŸ”§ jsæœ€ä½³å®è·µ

### ä¸€ã€å˜é‡

#### ä¿æŒç»Ÿä¸€

å¯¹åŒä¸€ç±»å‹çš„å˜é‡ä½¿ç”¨ç›¸åŒçš„å‘½åä¿æŒç»Ÿä¸€ï¼š

```js
// Bad:
getUserInfo();
getClientData();
getCustomerRecord();
// Good:
getUser()
```

#### æ¯ä¸ªå¸¸é‡(å…¨å¤§å†™)éƒ½è¯¥å‘½å

å¯ä»¥ç”¨ ESLint æ£€æµ‹ä»£ç ä¸­æœªå‘½åçš„å¸¸é‡ã€‚

```js
// Bad:
// å…¶ä»–äººçŸ¥é“ 86400000 çš„æ„æ€å—ï¼Ÿ
setTimeout( blastOff, 86400000 );
// Good:
const MILLISECOND_IN_A_DAY = 86400000;
setTimeout( blastOff, MILLISECOND_IN_A_DAY );
```

#### ä¼ å‚ä½¿ç”¨é»˜è®¤å€¼

```js
// Bad:
function createMicrobrewery( name ) {
    const breweryName = name || 'Hipster Brew Co.';
    // ...
}
// Good:
function createMicrobrewery( name = 'Hipster Brew Co.' ) {
    // ...
}
```

### äºŒã€å‡½æ•°

#### å‡½æ•°å‚æ•°( æœ€å¥½ 2 ä¸ªæˆ–æ›´å°‘ )

å¦‚æœå‚æ•°è¶…è¿‡ä¸¤ä¸ªï¼Œå»ºè®®ä½¿ç”¨ ES6 çš„è§£æ„è¯­æ³•ï¼Œä¸ç”¨è€ƒè™‘å‚æ•°çš„é¡ºåºã€‚

```js
// Bad:
function createMenu( title, body, buttonText, cancellable ) {
    // ...
}
// Good:
function createMenu( { title, body, buttonText, cancellable } ) {
    // ...
}
createMenu({
    title: 'Foo',
    body: 'Bar',
    buttonText: 'Baz',
    cancellable: true
});
```

#### ä¸€ä¸ªæ–¹æ³•åªåšä¸€ä»¶äº‹æƒ…

è¿™æ˜¯ä¸€æ¡åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸæµä¼ ä¹…è¿œçš„è§„åˆ™ã€‚ä¸¥æ ¼éµå®ˆè¿™æ¡è§„åˆ™ä¼šè®©ä½ çš„ä»£ç å¯è¯»æ€§æ›´å¥½ï¼Œä¹Ÿæ›´å®¹æ˜“é‡æ„ã€‚å¦‚æœè¿åè¿™ä¸ªè§„åˆ™ï¼Œé‚£ä¹ˆä»£ç ä¼šå¾ˆéš¾è¢«æµ‹è¯•æˆ–è€…é‡ç”¨ã€‚

```js
// Bad:
function emailClients( clients ) {
    clients.forEach( client => {
        const clientRecord = database.lookup( client );
        if ( clientRecord.isActive() ) {
            email( client );
        }
    });
}
// Good:
function emailActiveClients( clients ) {
    clients
        .filter( isActiveClient )
        .forEach( email );
}
function isActiveClient( client ) {
    const clientRecord = database.lookup( client );    
    return clientRecord.isActive();
}
```

#### å‡½æ•°åä¸Šä½“ç°å®ƒçš„ä½œç”¨

```js
// Bad:
function addToDate( date, month ) {
    // ...
}
const date = new Date();
// å¾ˆéš¾çŸ¥é“æ˜¯æŠŠä»€ä¹ˆåŠ åˆ°æ—¥æœŸä¸­
addToDate( date, 1 );
// Good:
function addMonthToDate( month, date ) {
    // ...
}
const date = new Date();
addMonthToDate( 1, date );
```

#### ä½¿ç”¨ Object.assign è®¾ç½®é»˜è®¤å±æ€§

```js
// Bad:
const menuConfig = {
  title: null,
  body: 'Bar',
  buttonText: null,
  cancellable: true
};
function createMenu(config) {
  config.title = config.title || 'Foo';
  config.body = config.body || 'Bar';
  config.buttonText = config.buttonText || 'Baz';
  config.cancellable = config.cancellable !== undefined ? config.cancellable : true;
}
createMenu(menuConfig);
// Good:
const menuConfig = {
  title: 'Order',
  // ä¸åŒ…å« body
  buttonText: 'Send',
  cancellable: true
};
function createMenu(config) {
  config = Object.assign({
    title: 'Foo',
    body: 'Bar',
    buttonText: 'Baz',
    cancellable: true
  }, config);
  // config : {title: "Order", body: "Bar", buttonText: "Send", cancellable: true}
  // ...
}
createMenu(menuConfig);
```

#### å°½é‡ä¸è¦å†™å…¨å±€æ–¹æ³•

åœ¨ JavaScript ä¸­ï¼Œæ°¸è¿œä¸è¦æ±¡æŸ“å…¨å±€ï¼Œä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­äº§ç”Ÿéš¾ä»¥é¢„æ–™çš„ bugã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä½ åœ¨ Array.prototype ä¸Šæ–°å¢ä¸€ä¸ª diff æ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„çš„ä¸åŒã€‚è€Œä½ åŒäº‹ä¹Ÿæ‰“ç®—åšç±»ä¼¼çš„äº‹æƒ…ï¼Œä¸è¿‡ä»–çš„ diff æ–¹æ³•æ˜¯ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„é¦–ä½å…ƒç´ çš„ä¸åŒã€‚å¾ˆæ˜æ˜¾ä½ ä»¬æ–¹æ³•ä¼šäº§ç”Ÿå†²çªï¼Œé‡åˆ°è¿™ç±»é—®é¢˜æˆ‘ä»¬å¯ä»¥ç”¨ ES2015/ES6 çš„è¯­æ³•æ¥å¯¹ Array è¿›è¡Œæ‰©å±•ã€‚

```js
// Bad:
Array.prototype.diff = function diff(comparisonArray) {
  const hash = new Set(comparisonArray);
  return this.filter(elem => !hash.has(elem));
};
// Good:
class SuperArray extends Array {
  diff(comparisonArray) {
    const hash = new Set(comparisonArray);
    return this.filter(elem => !hash.has(elem));        
  }
}
```

#### å°½é‡åˆ«ç”¨â€œéâ€æ¡ä»¶å¥

```js
// Bad:
function isDOMNodeNotPresent(node) {
  // ...
}
if (!isDOMNodeNotPresent(node)) {
  // ...
}
// Good:
function isDOMNodePresent(node) {
  // ...
}
if (isDOMNodePresent(node)) {
  // ...
}
```

#### ä¸è¦è¿‡åº¦ä¼˜åŒ–

ç°ä»£æµè§ˆå™¨å·²ç»åœ¨åº•å±‚åšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œè¿‡å»çš„å¾ˆå¤šä¼˜åŒ–æ–¹æ¡ˆéƒ½æ˜¯æ— æ•ˆçš„ï¼Œä¼šæµªè´¹ä½ çš„æ—¶é—´ã€‚

```js
// Bad:
// ç°ä»£æµè§ˆå™¨å·²å¯¹æ­¤( ç¼“å­˜ list.length )åšäº†ä¼˜åŒ–ã€‚
for (let i = 0, len = list.length; i < len; i++) {
  // ...
}
// Good:
for (let i = 0; i < list.length; i++) {
  // ...
}
```

#### åˆ é™¤å¼ƒç”¨ä»£ç 

è¿™é‡Œæ²¡æœ‰å®ä¾‹ä»£ç ï¼Œåˆ é™¤å°±å¯¹äº†

ğŸ’¬[åšæ–‡-[è¯‘] å¦‚ä½•å†™å‡ºæ¼‚äº®çš„ JavaScript ä»£ç ](https://juejin.im/post/5d0e11196fb9a07eee5ed6d2)

# Whatâ€™s Improvement

## ExpressionChangedAfterItHasBeenCheckedError | [Angular]()

### ç›¸å…³å˜æ›´æ£€æµ‹è¡Œä¸º

ä¸€ä¸ªè¿è¡Œçš„ Angular ç¨‹åºå…¶å®æ˜¯ä¸€ä¸ªç»„ä»¶æ ‘ï¼Œåœ¨å˜æ›´æ£€æµ‹æœŸé—´ï¼ŒAngular ä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºæ£€æŸ¥æ¯ä¸€ä¸ªç»„ä»¶:

- æ›´æ–°æ‰€æœ‰å­ç»„ä»¶ / æŒ‡ä»¤çš„ç»‘å®šå±æ€§
- è°ƒç”¨æ‰€æœ‰å­ç»„ä»¶ / æŒ‡ä»¤çš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼šngOnInitï¼ŒOnChangesï¼ŒngDoCheck
- æ›´æ–°å½“å‰ç»„ä»¶çš„ DOM
- ä¸ºå­ç»„ä»¶æ‰§è¡Œå˜æ›´æ£€æµ‹ï¼ˆè¯‘è€…æ³¨ï¼šåœ¨å­ç»„ä»¶ä¸Šé‡å¤ä¸Šé¢ä¸‰ä¸ªæ­¥éª¤ï¼Œä¾æ¬¡é€’å½’ä¸‹å»ï¼‰
- ä¸ºæ‰€æœ‰å­ç»„ä»¶ / æŒ‡ä»¤è°ƒç”¨å½“å‰ç»„ä»¶çš„ ngAfterViewInit ç”Ÿå‘½å‘¨æœŸé’©å­

åœ¨æ¯ä¸€æ¬¡æ“ä½œåï¼ŒAngular ä¼šè®°ä¸‹æ‰§è¡Œå½“å‰æ“ä½œæ‰€éœ€è¦çš„å€¼ï¼Œå¹¶å­˜æ”¾åœ¨ç»„ä»¶è§†å›¾çš„ oldValues å±æ€§é‡Œã€‚åœ¨æ‰€æœ‰ç»„ä»¶çš„æ£€æŸ¥æ›´æ–°æ“ä½œå®Œæˆåï¼ŒAngular å¹¶ä¸æ˜¯é©¬ä¸Šæ¥ç€æ‰§è¡Œä¸Šé¢åˆ—è¡¨ä¸­çš„æ“ä½œï¼Œè€Œæ˜¯ä¼šå¼€å§‹ä¸‹ä¸€æ¬¡ digest cycleï¼Œå³ Angular ä¼šæŠŠæ¥è‡ªä¸Šä¸€æ¬¡ digest cycle çš„å€¼ä¸å½“å‰å€¼æ¯”è¾ƒ:

- æ£€æŸ¥å·²ç»ä¼ ç»™å­ç»„ä»¶ç”¨æ¥æ›´æ–°å…¶å±æ€§çš„å€¼ï¼Œæ˜¯å¦ä¸å½“å‰å°†è¦ä¼ å…¥çš„å€¼ç›¸åŒ
- æ£€æŸ¥å·²ç»ä¼ ç»™å½“å‰ç»„ä»¶ç”¨æ¥æ›´æ–° DOM å€¼ï¼Œæ˜¯å¦ä¸å½“å‰å°†è¦ä¼ å…¥çš„å€¼ç›¸åŒ
- é’ˆå¯¹æ¯ä¸€ä¸ªå­ç»„ä»¶æ‰§è¡Œç›¸åŒçš„æ£€æŸ¥

### è§£å†³æ–¹æ¡ˆ

- å¼‚æ­¥æ›´æ–°```setTimeout```
- å¼ºè¿«å¼å˜æ›´æ£€æµ‹```this.cd.detectChanges();```

ğŸ’¬[åšæ–‡-[è¯‘]å…³äº `ExpressionChangedAfterItHasBeenCheckedError` é”™è¯¯ä½ æ‰€éœ€è¦çŸ¥é“çš„äº‹æƒ…](https://segmentfault.com/a/1190000013972657)