# Whatâ€™s New

## yarn | åŒ…ç®¡ç†å·¥å…·/yarn

### 1.ä»€ä¹ˆæ˜¯registry

registryæ˜¯ æ¨¡å—ä»“åº“æä¾›äº†ä¸€ä¸ªæŸ¥è¯¢æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æºã€‚

```yarn config get registry```

```yarn config set registry https://registry.npm.taobao.org/```

### 2.ä¾èµ–ç‰ˆæœ¬

ï½ å­—ç¬¦èŒƒå›´ï¼šåŒæ—¶ä½¿ç”¨å­—ç¬¦ ~ å’Œæ¬¡ç‰ˆæœ¬å·ï¼Œè¡¨æ˜å…è®¸ ä¿®è®¢å· å˜æ›´ã€‚åŒæ—¶ä½¿ç”¨å­—ç¬¦ ~ å’Œä¸»ç‰ˆæœ¬å·ï¼Œè¡¨æ˜å…è®¸ æ¬¡ç‰ˆæœ¬ å·å˜æ›´ã€‚

| è¡¨ç¤º | å«ä¹‰æè¿°               |
| ------ | -------------------------- |
| ~3.1.4 | >=3.1.4 <3.2.0             |
| ~3.1   | 3.1.x æˆ– > = 3.1.0 < 3.2.0 |
| ~3     | 3.x æˆ– > = 3.0.0 < 4.0.0  |

^ å­—ç¬¦èŒƒå›´ï¼šå­—ç¬¦ ^ è¡¨æ˜ä¸ä¼šä¿®æ”¹ç‰ˆæœ¬å·ä¸­çš„ç¬¬ä¸€ä¸ªéé›¶æ•°å­—

| è¡¨ç¤º | å«ä¹‰æè¿°   |
| ------ | -------------- |
| ^3.1.4 | >=3.1.4 <4.0.0 |
| ^0.4.2 | >=0.4.2 <0.5.0 |
| ^0.0.2 | >=0.0.2 <0.0.3 |

### 3.ä¾èµ–ç±»å‹

dependences devDependences peerDependences optionalDependencies bundledDependencies

### 4.ç¼“å­˜

```yarn``` ä¼šå°†å®‰è£…è¿‡çš„åŒ…ç¼“å­˜ä¸‹æ¥ï¼Œè¿™æ ·å†æ¬¡å®‰è£…ç›¸åŒåŒ…çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦å†å»ä¸‹è½½ï¼Œè€Œæ˜¯ç›´æ¥ä»ç¼“å­˜æ–‡ä»¶ä¸­ç›´æ¥copyè¿›æ¥ã€‚

å¯ä»¥é€šè¿‡å‘½ä»¤ ```yarn cache dir``` æŸ¥çœ‹yarnçš„å…¨å±€ç¼“å­˜ç›®å½•ã€‚æˆ‘çš„ç¼“å­˜ç›®å½•åœ¨ ```/Library/Caches/Yarn/v1``` ä¸‹ã€‚

### 5.yarn.lock

```yarn.lock``` ä¸­ä¼šå‡†ç¡®çš„å­˜å‚¨æ¯ä¸ªä¾èµ–çš„å…·ä½“ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥ä¿è¯åœ¨ä¸åŒæœºå™¨å®‰è£…å¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚

yarn.lockæ–‡ä»¶æ˜¯åœ¨å®‰è£…æœŸé—´ï¼Œç”± ```Yarn``` è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¹¶ä¸”ç”±yarnæ¥ç®¡ç†ï¼Œä¸åº”è¯¥æ‰‹åŠ¨å»æ›´æ”¹ï¼Œæ›´ä¸åº”è¯¥åˆ é™¤yarn.lockæ–‡ä»¶ï¼Œä¸”è¦æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ï¼Œä»¥å…å› ä¸ºä¸åŒæœºå™¨å®‰è£…çš„åŒ…ç‰ˆæœ¬ä¸ä¸€è‡´å¼•å‘é—®é¢˜ã€‚

### 6.Yarn installè¿‡ç¨‹

é¦–æ¬¡æ‰§è¡Œ ```yarn install``` å®‰è£…ï¼Œä¼šæŒ‰ç…§ ```package.json``` ä¸­çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼Œå»å‘ ```registry``` è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶è·å–åˆ°ç¬¦åˆç‰ˆæœ¬è§„åˆ™çš„æœ€æ–°çš„ä¾èµ–åŒ…è¿›è¡Œä¸‹è½½ï¼Œå¹¶æ„å»ºæ„å»ºä¾èµ–å…³ç³»æ ‘ã€‚ æ¯”å¦‚åœ¨ package.json ä¸­æŒ‡å®š vue çš„ç‰ˆæœ¬ä¸º ^2.0.0ï¼Œå°±ä¼šè·å–ç¬¦åˆ 2.x.x
çš„æœ€é«˜ç‰ˆæœ¬çš„åŒ…ã€‚ç„¶åè‡ªåŠ¨ç”Ÿæˆ yarn.lock æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆç¼“å­˜ã€‚
ä¹‹åå†æ‰§è¡Œ ```yarn install```ï¼Œä¼šå¯¹æ¯” ```package.json``` ä¸­ä¾èµ–ç‰ˆæœ¬èŒƒå›´å’Œ ```yarn.lock``` ä¸­ç‰ˆæœ¬å·æ˜¯å¦åŒ¹é…ã€‚

ç‰ˆæœ¬å·åŒ¹é…ï¼Œä¼šæ ¹æ® yarn.lock ä¸­çš„ resolved å­—æ®µå»æŸ¥çœ‹ç¼“å­˜ï¼Œ å¦‚æœæœ‰ç¼“å­˜ï¼Œç›´æ¥copyï¼Œæ²¡æœ‰ç¼“å­˜åˆ™æŒ‰ç…§ ```resolved``` å­—æ®µçš„urlå»ä¸‹è½½åŒ…ã€‚
ç‰ˆæœ¬å·ä¸åŒ¹é…ï¼Œæ ¹æ® ```package.json``` ä¸­çš„ç‰ˆæœ¬èŒƒå›´å» registry æŸ¥è¯¢ï¼Œä¸‹è½½ç¬¦åˆç‰ˆæœ¬è§„åˆ™æœ€æ–°çš„åŒ…ï¼Œå¹¶æ›´æ–°è‡³ ```yarn.lock``` ä¸­ã€‚

### 7.æ¨¡å—æ‰å¹³åŒ–

ä¸ºäº†ä¿è¯ä¾èµ–å…³ç³»æ ‘ä¸­æ²¡æœ‰å¤§é‡é‡å¤æ¨¡å—ï¼Œyarnåœ¨å®‰è£…æ—¶ä¼šåšdedupeï¼ˆå»é‡ï¼‰æ“ä½œï¼Œå®ƒä¼šéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œé€ä¸ªå°†æ¨¡å—æ”¾åœ¨æ ¹èŠ‚ç‚¹ä¸‹é¢ï¼Œä¹Ÿå°±æ˜¯å½“å‰é¡¹ç›®çš„ ```node-modules``` ä¸­ã€‚å½“å‘ç°æœ‰ç›¸åŒçš„æ¨¡å—æ—¶ï¼Œä¼šåˆ¤æ–­å½“å‰æ¨¡å—æŒ‡å®šçš„ ```semver``` ç‰ˆæœ¬èŒƒå›´æ˜¯å¦äº¤é›†ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åªä¿ç•™å…¼å®¹ç‰ˆæœ¬ï¼Œå¦‚æœæ²¡æœ‰åˆ™åœ¨å½“å‰çš„åŒ…çš„ ```node-modules``` ä¸‹å®‰è£…ã€‚

### 8.å¸¸ç”¨çš„yarnå‘½ä»¤

#### yarn install å®‰è£…ä¾èµ–

```shell
yarn install / yarn  åœ¨æœ¬åœ° node_modules ç›®å½•å®‰è£… package.json é‡Œåˆ—å‡ºçš„æ‰€æœ‰ä¾èµ–
yarn install --force é‡æ–°æ‹‰å–æ‰€æœ‰åŒ…ï¼Œå³ä½¿ä¹‹å‰å·²ç»å®‰è£…çš„ï¼ˆæ‰€ä»¥ä»¥ååˆ«åœ¨åˆ é™¤node-modulesäº†...ï¼‰
yarn install --production[=true|false] / --production / --prod åªå®‰è£… dependenceä¸‹çš„åŒ…ï¼Œä¸å®‰è£… devDependencies çš„åŒ…
```

#### yarn add

```shell
yarn add package-name ä¼šå®‰è£… latest æœ€æ–°ç‰ˆæœ¬ã€‚
yarn add <package...>  å®‰è£…åŒ…åˆ°dependenciesä¸­
yarn add <package...> [--dev/-D]  ç”¨ --dev æˆ– -D å®‰è£…åŒ…åˆ° devDependencies
yarn add <package...> [--optional/-O] ç”¨ --optional æˆ–è€… -O å®‰è£…åŒ…åˆ° optionalDependencies
yarn add <package...> [--exact/-E] ç”¨ --exact æˆ–è€… -E ä¼šå®‰è£…åŒ…çš„ç²¾ç¡®ç‰ˆæœ¬ã€‚é»˜è®¤æ˜¯å®‰è£…åŒ…çš„ä¸»è¦ç‰ˆæœ¬é‡Œçš„æœ€æ–°ç‰ˆæœ¬ã€‚ æ¯”å¦‚è¯´ï¼Œ yarn add foo@1.2.3 ä¼šæ¥å— 1.9.1 ç‰ˆï¼Œä½†æ˜¯ yarn add foo@1.2.3 --exact åªä¼šæ¥å— 1.2.3 ç‰ˆã€‚
yarn add <package...> [--tilde/-T]  ç”¨ --tilde æˆ–è€… -T æ¥å®‰è£…åŒ…çš„æ¬¡è¦ç‰ˆæœ¬é‡Œçš„æœ€æ–°ç‰ˆã€‚ é»˜è®¤æ˜¯å®‰è£…åŒ…çš„ä¸»è¦ç‰ˆæœ¬é‡Œçš„æœ€æ–°ç‰ˆæœ¬ã€‚ æ¯”å¦‚è¯´ï¼Œyarn add foo@1.2.3 --tilde ä¼šæ¥å— 1.2.9ï¼Œä½†ä¸æ¥å— 1.3.0ã€‚
```

#### yarn config ç®¡ç†é…ç½®æ–‡ä»¶

#### å…¶ä»–å¸¸ç”¨å‘½ä»¤

```shell
yarn list æŸ¥è¯¢å½“å‰å·¥ä½œæ–‡ä»¶å¤¹æ‰€æœ‰çš„ä¾èµ–
yarn info <package> [<field>]  æŸ¥çœ‹åŒ…ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹ç‰¹å®š
yarn remove <package...>  ä»ä¾èµ–é‡Œç§»é™¤ååŒ…ï¼ŒåŒæ—¶æ›´æ–°ä½  package.json å’Œ yarn.lock æ–‡ä»¶ã€‚
yarn <script> [<args>] æ‰§è¡Œç”¨æˆ·è‡ªå®šä¹‰çš„è„šæœ¬
```

ğŸ’¬[(å…¨)å‰ç«¯å·¥ç¨‹å¸ˆåº”è¯¥çŸ¥é“çš„yarnçŸ¥è¯†](https://juejin.im/post/5da9c6b0e51d4524d67486e2)
